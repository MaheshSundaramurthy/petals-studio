<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
	<link href="book.css" rel="stylesheet" type="text/css" />
	<title>Deploying an SCA application on Petals</title>
</head>

<body>
<h1>Deploying an SCA application on Petals</h1>
<p>
Deploying an SCA application on Petals consists in creating a deployment for 
the Petals SCA component.<br />
The different ways of doing this are described here.
</p>

<h2>Using the Eclipse plug-ins</h2>
<p>
Select <b>File &gt; Export... &gt; Petals &gt; Service Assembly for SCA</b>.<br />
Or right-click your project and select <b>Petals &gt; Package for Petals</b>.
</p>
<img src="images/package.gif" alt="Package for Petals" />

<p>
The packaging operation is configured through a wizard made up of three pages.<br />
The first page configures the generation of the jbi.xml file and the target file. <br />
Select the project to export, the SCA composite/application to expose, the version 
of the Petals SCA component to target and the destination file.
</p>
<img src="images/packagePage1.gif" alt="The first page for the packaging" />

<p>
Click <b>Next</b> when this is done.<br />
The second page deals with the java implementations.<br />
On this page, you have to select all the elements that will be added to the implementation jar file.
Java projects referenced by your project are also part of this page.<br />
Make sure to <b>embed the SCA artifacts in the jar</b> (*.composite).
</p>
<img src="images/packagePage2.gif" alt="The second page for the packaging" />

<p>
Click <b>Next</b> to display the last page.<br />
This one deals with the classpath, i.e. all the libraries your project (and its
referenced projects) depend(s) on. Select the ones to embed in the deployment archive.
</p>
<img src="images/packagePage3.gif" alt="The last page for the packaging" />

<p>
Click <b>Finish</b> to start the archive creation.<br />
The created archive should be at the location you gave. It should contain the following artifacts:
</p>
<ul>
	<li>META-INF</li>
	<li>META-INF/jbi.xml</li>
	<li>A *.zip archive</li>
</ul>
<p>The *.zip archive must contain:</p>
<ul>
	<li>META-INF</li>
	<li>META-INF/jbi.xml</li>
	<li>At least one *.jar file (the SCA implementation + the class path libraries)</li>
	<li>WSDLs and related resources (XSDs, XMLs)</li>
</ul>


<h2>Using the Petals Maven plug-in</h2>
<p>
This kind of packaging applies when you created a Maven project structure.<br />
The only missing thing for this project is the JBI descriptor.<br />
You can generate one by selecting <b>File &gt; Export... &gt; Petals &gt; JBI Descriptor for SCA</b>.<br />
Or right-click on the SCA composite and select <b>Petals &gt; Generate jbi.xml</b>.
</p>
<img src="images/generateJbiXml.gif" alt="Generate a jbi.xml from an SCA composite" />

<p>You should then get the following page.</p>
<img src="images/generateJbiXmlPage1.gif" alt="Generate a jbi.xml from an SCA composite - page 1" />
<p>
Just make sure the destination file is the <b>src/main/jbi</b> folder of your project.
You can then use the Petals Maven plug-in as usual.
</p>


<h2>Classic package for Petals</h2>
<p>
Few words about it.<br />
This kind of packaging is available in the Petals SCA plug-in. It works as the usual action
"package for Petals", which is available on non-Java projects for Petals.
</p><p>
It can be used as an emergency packaging solution, in case where others would not work correctly. This packaging copy every resource located
in the resource folder of the project. For SCA, it means you can create your implementation jar with the usual
Java tooling, and then save it in the project. The <i>classic packaging</i> will put it int he deployment archive
it generates.
</p>

</body>
</html>