<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?>

<!--
 <copyright>
	 Copyright (c) 2008-2011, EBM WebSourcing
	  
	 This source code is available under agreement available at
	 http://www.petalslink.com/legal/licenses/petals-studio
	  
	 You should have received a copy of the agreement along with this program.
	 If not, write to EBM WebSourcing (4, rue Amelie - 31200 Toulouse, France).
 </copyright>
-->

<plugin>
	<extension
         point="com.ebmwebsourcing.petals.services.contentExtension">
      <WizardData
            SuType="SCA"
            ContributorDescription="com.ebmwebsourcing.petals.services.sca.ScaContributorDescription">
         <Version
               LastActionsPerformer="com.ebmwebsourcing.petals.services.sca.configuration.ScaLastActionsPerformer11"
               ProvideConfiguration="com.ebmwebsourcing.petals.services.sca.configuration.ScaWizardConfiguration11"
               SuVersion="1.1">
            <WizardPage
                  WizardPageClass="com.ebmwebsourcing.petals.services.sca.configuration.ScaWizardPage11"
                  WizardPageMode="Provide"
                  WizardPagePosition="beforeJbiPage">
            </WizardPage>
            <WizardPage
                  WizardPageClass="com.ebmwebsourcing.petals.services.sca.configuration.ScaConsumeWizardPage"
                  WizardPageMode="Provide"
                  WizardPagePosition="afterCdkPage">
            </WizardPage>
         </Version>
      </WizardData>
   </extension>
 
 
 <extension
       point="org.eclipse.help.toc">
    <toc
          file="doc/tocsca.xml"
          primary="false">
    </toc>
 </extension>
 <extension
       point="org.eclipse.ui.handlers">
    <handler
          class="com.ebmwebsourcing.petals.services.sca.export.ScaSketchExportHandler"
          commandId="com.ebmwebsourcing.petals.services.projectSketch">
       <enabledWhen>
          <with
                variable="selection">
             <and>
                <count
                      value="1">
                </count>
                <iterate
                      ifEmpty="false"
                      operator="and">
                   <and>
                      <instanceof
                            value="org.eclipse.core.resources.IProject">
                      </instanceof>
                      <test
                            property="org.eclipse.core.resources.projectNature"
                            value="org.eclipse.stp.sca.common.scaNature">
                      </test>
                      <test
                            property="org.eclipse.core.resources.projectNature"
                            value="com.ebmwebsourcing.petals.tools.eclipse.su.main.nature">
                      </test>
                      <test
                            property="com.ebmwebsourcing.petals.services.sketch"
                            value="true">
                      </test>
                   </and>
                </iterate>
             </and>
          </with>
       </enabledWhen>
       <activeWhen>
          <with
                variable="selection">
             <and>
                <count
                      value="1">
                </count>
                <iterate
                      ifEmpty="false"
                      operator="and">
                   <and>
                      <instanceof
                            value="org.eclipse.core.resources.IProject">
                      </instanceof>
                      <test
                            property="org.eclipse.core.resources.projectNature"
                            value="org.eclipse.stp.sca.common.scaNature">
                      </test>
                      <test
                            property="org.eclipse.core.resources.projectNature"
                            value="com.ebmwebsourcing.petals.tools.eclipse.su.main.nature">
                      </test>
                      <test
                            property="com.ebmwebsourcing.petals.services.sketch"
                            value="true">
                      </test>
                   </and>
                </iterate>
             </and>
          </with>
       </activeWhen>
    </handler>
 </extension>
 <extension
       point="org.eclipse.ui.views.properties.tabbed.propertyTabs">
    <propertyTabs
          contributorId="org.eclipse.soa.sca.sca1_0.diagram">
       <propertyTab
             category="domain"
             id="com.ebmwebsourcing.petals.services.sca.petalsTab"
             image="icons/obj16/pstudio_16x16_2.png"
             label="Petals">
       </propertyTab>
    </propertyTabs>
 </extension>
 <extension
       point="org.eclipse.ui.views.properties.tabbed.propertySections">
    <propertySections
          contributorId="org.eclipse.soa.sca.sca1_0.diagram">
       <propertySection
             class="com.ebmwebsourcing.petals.services.sca.tabbedproperties.PetalsSingleSection"
             filter="com.ebmwebsourcing.petals.services.sca.tabbedproperties.SelectionFilter"
             id="com.ebmwebsourcing.petals.services.sca.petalsSection"
             tab="com.ebmwebsourcing.petals.services.sca.petalsTab">
          <input
                type="org.eclipse.gmf.runtime.notation.View">
          </input>
          <input
                type="org.eclipse.gef.EditPart">
          </input>
       </propertySection>
    </propertySections>
 </extension>
 <extension
       point="org.eclipse.ui.menus">
    <menuContribution
          locationURI="popup:com.ebmwebsourcing.petals.common.actiongroup?after=com.ebmwebsourcing.petals.common.group.edit">
       <command
             commandId="com.ebmwebsourcing.petals.services.sca.generateJbiXml"
             label="Complete Petals Services"
             style="push">
          <visibleWhen
                checkEnabled="false">
             <with
                   variable="selection">
                <count
                      value="1">
                </count>
                <iterate
                      ifEmpty="false"
                      operator="and">
                   <and>
                      <instanceof
                            value="org.eclipse.core.resources.IFile">
                      </instanceof>
                      <test
                            property="org.eclipse.core.resources.extension"
                            value="composite">
                      </test>
                      <test
                      	property="org.eclipse.core.resources.projectNature"
                       	value="com.ebmwebsourcing.petals.tools.eclipse.su.main.nature">
                      </test>
                      <test
                           property="com.ebmwebsourcing.petals.services.component-name"
                           value="petals-se-sca">
                      </test>
                   </and>
                </iterate>
             </with>
          </visibleWhen>
       </command>
    </menuContribution>
 </extension>
 <extension
       point="org.eclipse.ui.commands">
    <command
          categoryId="com.ebmwebsourcing.jbi.core.petals-category"
          defaultHandler="com.ebmwebsourcing.petals.services.sca.handlers.ScaGenerationHandler"
          description="Generate a jbi.xml from a composite file"
          id="com.ebmwebsourcing.petals.services.sca.generateJbiXml"
          name="Generate jbi.xml">
    </command>
 </extension>
 <extension
       point="org.eclipse.ui.newWizards">
    <wizard
          category="com.ebmwebsourcing.petals.common.wizards.utilities"
          class="com.ebmwebsourcing.petals.services.sca.wizards.PetalsReferenceWizard"
          hasPages="true"
          icon="icons/obj16/reference_16x16.png"
          id="com.ebmwebsourcing.petals.services.sca.petalsReference"
          name="Petals SCA reference"
          project="false">
       <description>
          Create a new SCA reference that targets a Petals service
       </description>
    </wizard>
 </extension>
</plugin>
